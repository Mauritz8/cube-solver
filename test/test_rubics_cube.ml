open Rubics_cube.Cube

(* Scramble: D2 R2 D' L2 U L R2 U' D R' D' R B R' F D F' R B' U F2 B U2 F2 L *)
(* White on top and green on the front *)
(* Generated by https://ruwix.com/puzzle-scramble-generator/?type=rubiks-cube *)
let cube =
  {
    front = [ RED; BLUE; RED; YELLOW; GREEN; ORANGE; WHITE; BLUE; YELLOW ];
    back = [ WHITE; RED; ORANGE; RED; BLUE; ORANGE; WHITE; BLUE; BLUE ];
    right = [ GREEN; ORANGE; BLUE; YELLOW; RED; YELLOW; ORANGE; RED; BLUE ];
    left = [ GREEN; YELLOW; BLUE; WHITE; ORANGE; GREEN; ORANGE; GREEN; GREEN ];
    top = [ WHITE; GREEN; RED; BLUE; WHITE; GREEN; YELLOW; ORANGE; YELLOW ];
    bottom = [ RED; RED; GREEN; WHITE; YELLOW; WHITE; YELLOW; WHITE; ORANGE ];
  }

let move_up_clockwise_test () =
  let expect =
    {
      front =
        [ GREEN; ORANGE; BLUE; YELLOW; GREEN; ORANGE; WHITE; BLUE; YELLOW ];
      back = [ GREEN; YELLOW; BLUE; RED; BLUE; ORANGE; WHITE; BLUE; BLUE ];
      right = [ WHITE; RED; ORANGE; YELLOW; RED; YELLOW; ORANGE; RED; BLUE ];
      left = [ RED; BLUE; RED; WHITE; ORANGE; GREEN; ORANGE; GREEN; GREEN ];
      top = [ YELLOW; BLUE; WHITE; ORANGE; WHITE; GREEN; YELLOW; GREEN; RED ];
      bottom = [ RED; RED; GREEN; WHITE; YELLOW; WHITE; YELLOW; WHITE; ORANGE ];
    }
  in
  let actual = make_move cube { direction = UP; clockwise = true } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_up_counter_clockwise_test () =
  let expect =
    {
      front =
        [ GREEN; YELLOW; BLUE; YELLOW; GREEN; ORANGE; WHITE; BLUE; YELLOW ];
      back = [ GREEN; ORANGE; BLUE; RED; BLUE; ORANGE; WHITE; BLUE; BLUE ];
      right = [ RED; BLUE; RED; YELLOW; RED; YELLOW; ORANGE; RED; BLUE ];
      left = [ WHITE; RED; ORANGE; WHITE; ORANGE; GREEN; ORANGE; GREEN; GREEN ];
      top = [ RED; GREEN; YELLOW; GREEN; WHITE; ORANGE; WHITE; BLUE; YELLOW ];
      bottom = [ RED; RED; GREEN; WHITE; YELLOW; WHITE; YELLOW; WHITE; ORANGE ];
    }
  in
  let actual = make_move cube { direction = UP; clockwise = false } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_down_clockwise_test () =
  let expect =
    {
      front = [ RED; BLUE; RED; YELLOW; GREEN; ORANGE; ORANGE; GREEN; GREEN ];
      back = [ WHITE; RED; ORANGE; RED; BLUE; ORANGE; ORANGE; RED; BLUE ];
      right = [ GREEN; ORANGE; BLUE; YELLOW; RED; YELLOW; WHITE; BLUE; YELLOW ];
      left = [ GREEN; YELLOW; BLUE; WHITE; ORANGE; GREEN; WHITE; BLUE; BLUE ];
      top = [ WHITE; GREEN; RED; BLUE; WHITE; GREEN; YELLOW; ORANGE; YELLOW ];
      bottom = [ YELLOW; WHITE; RED; WHITE; YELLOW; RED; ORANGE; WHITE; GREEN ];
    }
  in
  let actual = make_move cube { direction = DOWN; clockwise = true } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_down_counter_clockwise_test () =
  let expect =
    {
      front = [ RED; BLUE; RED; YELLOW; GREEN; ORANGE; ORANGE; RED; BLUE ];
      back = [ WHITE; RED; ORANGE; RED; BLUE; ORANGE; ORANGE; GREEN; GREEN ];
      right = [ GREEN; ORANGE; BLUE; YELLOW; RED; YELLOW; WHITE; BLUE; BLUE ];
      left = [ GREEN; YELLOW; BLUE; WHITE; ORANGE; GREEN; WHITE; BLUE; YELLOW ];
      top = [ WHITE; GREEN; RED; BLUE; WHITE; GREEN; YELLOW; ORANGE; YELLOW ];
      bottom = [ GREEN; WHITE; ORANGE; RED; YELLOW; WHITE; RED; WHITE; YELLOW ];
    }
  in
  let actual = make_move cube { direction = DOWN; clockwise = false } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_right_clockwise_test () =
  let expect =
    {
      front = [ RED; BLUE; GREEN; YELLOW; GREEN; WHITE; WHITE; BLUE; ORANGE ];
      back = [ YELLOW; RED; ORANGE; GREEN; BLUE; ORANGE; RED; BLUE; BLUE ];
      right = [ ORANGE; YELLOW; GREEN; RED; RED; ORANGE; BLUE; YELLOW; BLUE ];
      left = [ GREEN; YELLOW; BLUE; WHITE; ORANGE; GREEN; ORANGE; GREEN; GREEN ];
      top = [ WHITE; GREEN; RED; BLUE; WHITE; ORANGE; YELLOW; ORANGE; YELLOW ];
      bottom = [ RED; RED; WHITE; WHITE; YELLOW; RED; YELLOW; WHITE; WHITE ];
    }
  in
  let actual = make_move cube { direction = RIGHT; clockwise = true } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_right_counter_clockwise_test () =
  let expect =
    {
      front = [ RED; BLUE; RED; YELLOW; GREEN; GREEN; WHITE; BLUE; YELLOW ];
      back = [ ORANGE; RED; ORANGE; WHITE; BLUE; ORANGE; GREEN; BLUE; BLUE ];
      right = [ BLUE; YELLOW; BLUE; ORANGE; RED; RED; GREEN; YELLOW; ORANGE ];
      left = [ GREEN; YELLOW; BLUE; WHITE; ORANGE; GREEN; ORANGE; GREEN; GREEN ];
      top = [ WHITE; GREEN; WHITE; BLUE; WHITE; RED; YELLOW; ORANGE; WHITE ];
      bottom = [ RED; RED; RED; WHITE; YELLOW; ORANGE; YELLOW; WHITE; YELLOW ];
    }
  in
  let actual = make_move cube { direction = RIGHT; clockwise = false } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_left_clockwise_test () =
  let expect =
    {
      front = [ WHITE; BLUE; RED; BLUE; GREEN; ORANGE; YELLOW; BLUE; YELLOW ];
      back = [ WHITE; RED; YELLOW; RED; BLUE; WHITE; WHITE; BLUE; RED ];
      right = [ GREEN; ORANGE; BLUE; YELLOW; RED; YELLOW; ORANGE; RED; BLUE ];
      left = [ ORANGE; WHITE; GREEN; GREEN; ORANGE; YELLOW; GREEN; GREEN; BLUE ];
      top = [ BLUE; GREEN; RED; ORANGE; WHITE; GREEN; ORANGE; ORANGE; YELLOW ];
      bottom = [ RED; RED; GREEN; YELLOW; YELLOW; WHITE; WHITE; WHITE; ORANGE ];
    }
  in
  let actual = make_move cube { direction = LEFT; clockwise = true } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_left_counter_clockwise_test () =
  let expect =
    {
      front = [ RED; BLUE; RED; WHITE; GREEN; ORANGE; YELLOW; BLUE; YELLOW ];
      back = [ WHITE; RED; YELLOW; RED; BLUE; BLUE; WHITE; BLUE; WHITE ];
      right = [ GREEN; ORANGE; BLUE; YELLOW; RED; YELLOW; ORANGE; RED; BLUE ];
      left = [ BLUE; GREEN; GREEN; YELLOW; ORANGE; GREEN; GREEN; WHITE; ORANGE ];
      top = [ RED; GREEN; RED; YELLOW; WHITE; GREEN; WHITE; ORANGE; YELLOW ];
      bottom =
        [ BLUE; RED; GREEN; ORANGE; YELLOW; WHITE; ORANGE; WHITE; ORANGE ];
    }
  in
  let actual = make_move cube { direction = LEFT; clockwise = false } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_front_clockwise_test () =
  let expect =
    {
      front = [ WHITE; YELLOW; RED; BLUE; GREEN; BLUE; YELLOW; ORANGE; RED ];
      back = [ WHITE; RED; ORANGE; RED; BLUE; ORANGE; WHITE; BLUE; BLUE ];
      right = [ YELLOW; ORANGE; BLUE; ORANGE; RED; YELLOW; YELLOW; RED; BLUE ];
      left = [ GREEN; YELLOW; RED; WHITE; ORANGE; RED; ORANGE; GREEN; GREEN ];
      top = [ WHITE; GREEN; RED; BLUE; WHITE; GREEN; GREEN; GREEN; BLUE ];
      bottom =
        [ ORANGE; YELLOW; GREEN; WHITE; YELLOW; WHITE; YELLOW; WHITE; ORANGE ];
    }
  in
  let actual = make_move cube { direction = FRONT; clockwise = true } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_front_counter_clockwise_test () =
  let expect =
    {
      front = [ RED; ORANGE; YELLOW; BLUE; GREEN; BLUE; RED; YELLOW; WHITE ];
      back = [ WHITE; RED; ORANGE; RED; BLUE; ORANGE; WHITE; BLUE; BLUE ];
      right = [ GREEN; ORANGE; BLUE; RED; RED; YELLOW; RED; RED; BLUE ];
      left =
        [ GREEN; YELLOW; YELLOW; WHITE; ORANGE; ORANGE; ORANGE; GREEN; YELLOW ];
      top = [ WHITE; GREEN; RED; BLUE; WHITE; GREEN; GREEN; YELLOW; ORANGE ];
      bottom =
        [ BLUE; GREEN; GREEN; WHITE; YELLOW; WHITE; YELLOW; WHITE; ORANGE ];
    }
  in
  let actual = make_move cube { direction = FRONT; clockwise = false } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_back_clockwise_test () =
  let expect =
    {
      front = [ RED; BLUE; RED; YELLOW; GREEN; ORANGE; WHITE; BLUE; YELLOW ];
      back = [ WHITE; RED; WHITE; BLUE; BLUE; RED; BLUE; ORANGE; ORANGE ];
      right = [ GREEN; ORANGE; ORANGE; YELLOW; RED; WHITE; ORANGE; RED; YELLOW ];
      left = [ RED; YELLOW; BLUE; GREEN; ORANGE; GREEN; WHITE; GREEN; GREEN ];
      top = [ BLUE; YELLOW; BLUE; BLUE; WHITE; GREEN; YELLOW; ORANGE; YELLOW ];
      bottom = [ RED; RED; GREEN; WHITE; YELLOW; WHITE; GREEN; WHITE; ORANGE ];
    }
  in
  let actual = make_move cube { direction = BACK; clockwise = true } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let move_back_counter_clockwise_test () =
  let expect =
    {
      front = [ RED; BLUE; RED; YELLOW; GREEN; ORANGE; WHITE; BLUE; YELLOW ];
      back = [ ORANGE; ORANGE; BLUE; RED; BLUE; BLUE; WHITE; RED; WHITE ];
      right = [ GREEN; ORANGE; WHITE; YELLOW; RED; GREEN; ORANGE; RED; RED ];
      left =
        [ YELLOW; YELLOW; BLUE; WHITE; ORANGE; GREEN; ORANGE; GREEN; GREEN ];
      top = [ ORANGE; WHITE; GREEN; BLUE; WHITE; GREEN; YELLOW; ORANGE; YELLOW ];
      bottom = [ RED; RED; GREEN; WHITE; YELLOW; WHITE; BLUE; YELLOW; BLUE ];
    }
  in
  let actual = make_move cube { direction = BACK; clockwise = false } in
  Alcotest.(check string)
    "same front"
    (face_to_string expect.front)
    (face_to_string actual.front);
  Alcotest.(check string)
    "same back"
    (face_to_string expect.back)
    (face_to_string actual.back);
  Alcotest.(check string)
    "same right"
    (face_to_string expect.right)
    (face_to_string actual.right);
  Alcotest.(check string)
    "same left"
    (face_to_string expect.left)
    (face_to_string actual.left);
  Alcotest.(check string)
    "same top"
    (face_to_string expect.top)
    (face_to_string actual.top);
  Alcotest.(check string)
    "same bottom"
    (face_to_string expect.bottom)
    (face_to_string actual.bottom)

let () =
  let open Alcotest in
  run "Cube"
    [
      ( "moves",
        [
          test_case "Move up clockwise" `Quick move_up_clockwise_test;
          test_case "Move up counter clockwise" `Quick
            move_up_counter_clockwise_test;
          test_case "Move down clockwise" `Quick move_down_clockwise_test;
          test_case "Move down counter clockwise" `Quick
            move_down_counter_clockwise_test;
          test_case "Move right clockwise" `Quick move_right_clockwise_test;
          test_case "Move right counter clockwise" `Quick
            move_right_counter_clockwise_test;
          test_case "Move left clockwise" `Quick move_left_clockwise_test;
          test_case "Move left counter clockwise" `Quick
            move_left_counter_clockwise_test;
          test_case "Move front clockwise" `Quick move_front_clockwise_test;
          test_case "Move front counter clockwise" `Quick
            move_front_counter_clockwise_test;
          test_case "Move back clockwise" `Quick move_back_clockwise_test;
          test_case "Move back counter clockwise" `Quick
            move_back_counter_clockwise_test;
        ] );
    ]
